<!DOCTYPE html>
<html>
	<head>
		<script>
			const selectedDice = [];
			
			window.onload = init;

			function init(){
				// the code to be called when the dom has loaded
				// #document has its nodes
				var table = document.getElementById("diceTable");
				table.addEventListener("click", (event) => {
					if (event.target.matches("button.roll")) {
						rollIndividualDice(event.target);
					}
				});
			}

			function rollIndividualDice(element) {				
				const row = element.closest("tr");
				const rollValueElement = row.cells[row.cells.length - 1];
				let diceTypeElement = row.querySelector("select");
				const rollValue = getRndInteger(1, diceTypeElement.value);
				// TODO: Some text colouring?
				rollValueElement.innerText = rollValue;
			}
			function getRndInteger(min, max) {
				return Math.floor((Math.random() * max) + min);
			}
			
			function addDice(diceNumber) {
				selectedDice.push(diceNumber);
			}
			function removeDice(diceNumber) {
				selectedDice.pop(diceNumber);
			}
			function rollAllDice() {
				calculatedTotal = 0;
				for (i = 0; i < selectedDice.length; i++) {
					calculatedTotal += getRndInteger(selectedDice[i]);
				}
				document.getElementById("totalRollValue").innerHTML = calculatedTotal;
				return calculatedTotal;
			}
		</script>
	</head>
	<body>
		<h1>Renegade Dice Roller</h1>
		<table id="diceTable">
			<tr>
				<th>Dice Selector</th>
			</tr>
			<tr class="tableRow">
				<td>
					<select class="diceType">
						<option value="2">d2</option>
						<option value="4">d4</option>
						<option value="6">d6</option>
						<option value="8">d8</option>
						<option value="10">d10</option>
						<option value="12">d12</option>
						<option value="20">d20</option>
					</select>
				</td>
				<td>
					<button class="roll">Roll</button>
				</td>
				<td>
					<p></p>
				</td>
			</tr>
			<tr>
				<td>
					<button class="add">+</button>
				</td>
			</tr>
		</table>
		<button onclick="rollAllDice()">Roll All</button>
		<p>Total: <span id="totalRollValue" style="color:blue"></span></p>
	</body>
</html>